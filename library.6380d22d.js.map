{"mappings":"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","sources":["src/js/ui/library-page-ui.js","src/js/handlers/watchedTabClickHandler.js","src/js/loadDataFromStorage.js","src/js/handlers/queueTabClickHandler.js","src/js/handlers/libraryGalleryClickHandler.js","src/library.js"],"sourcesContent":["import refs from '../refs/refs';\nimport { watchedTabClickHandler } from '../handlers/watchedTabClickHandler';\nimport { queueTabClickHandler } from '../handlers/queueTabClickHandler';\nimport { libraryGalleryClickHandler } from '../handlers/libraryGalleryClickHandler';\nimport movieCards from '../../templates/movie-card.hbs';\nimport { dynamicRefs } from '../refs/dynamicRefs';\nimport { trackScroll, backToTop } from '../handlers/scrollUpClickHandler';\nimport modalMovie from '../../templates/modal-for-movie.hbs';\nimport {\n  modalQueueBtnClickHandler,\n  modalWatchedBtnClickHandler,\n  onOpenModal,\n} from '../handlers/modalBtnsClickHandler';\nimport { httpsYouTubeVideo } from '../you-tube';\nimport { submitRegisterForm } from '../api/firebase/fireBase';\n\nconst setLibraryEventListeners = () => {\n  refs.watchedTab.addEventListener('click', watchedTabClickHandler);\n  refs.queueTab.addEventListener('click', queueTabClickHandler);\n  refs.libraryGallery.addEventListener('click', libraryGalleryClickHandler);\n  refs.registerForm.addEventListener('submit', submitRegisterForm);\n  refs.goTopBtn.addEventListener('click', backToTop);\n  window.addEventListener('scroll', trackScroll);\n};\n\nconst appendGalleryMarkup = movies => {\n  refs.libraryGallery.innerHTML = movieCards(movies);\n};\n\nconst appendMovieMarkup = movie => {\n  dynamicRefs().movieData.innerHTML = modalMovie(movie);\n\n  dynamicRefs().watchedBtn.addEventListener(\n    'click',\n    modalWatchedBtnClickHandler\n  );\n  dynamicRefs().queueBtn.addEventListener('click', modalQueueBtnClickHandler);\n  onOpenModal(movie.id);\n  dynamicRefs().playTrailer.addEventListener('click', httpsYouTubeVideo);\n};\n\nfunction renderEmptyLibrary() {\n  const fillerLibrary =\n    '<p class=\"empty-page__text\"> Nothing to see here<br>Add a movie please</p>';\n  refs.libraryGallery.insertAdjacentHTML('afterbegin', fillerLibrary);\n}\nconst scrollToTop = () => {\n  window.scrollBy(0, 0);\n};\n\nexport default {\n  setLibraryEventListeners,\n  appendGalleryMarkup,\n  appendMovieMarkup,\n  renderEmptyLibrary,\n  scrollToTop,\n};\n","import refs from '../refs/refs';\nimport storage from '../local-storage/local-storage-service';\nimport key from '../local-storage/local-storage-keys';\nimport { fetchMovieById } from '../api/movie-api/fetchMovieById';\nimport libraryPageUi from '../ui/library-page-ui';\nimport paginationMarkup from '../pagination';\nimport { loadDataFromStorage } from '../loadDataFromStorage';\nimport { spinner } from '../spinner';\nimport { siteConfigs } from '../SiteConfigs';\n\nexport const watchedTabClickHandler = async event => {\n  console.log(1);\n  refs.watchedTab.classList.add('tabs__btn--current');\n  refs.queueTab.classList.remove('tabs__btn--current');\n\n  refs.libraryGallery.innerHTML = '';\n\n  const watchedMovieIds = await loadDataFromStorage(key.WATCHED_MOVIES);\n\n  if (!watchedMovieIds || watchedMovieIds.length === 0)\n    return libraryPageUi.renderEmptyLibrary();\n\n  processMovieIds(watchedMovieIds).then(data => {\n    renderLibraryMoviesData(data);\n  });\n};\n\nconst processMovieIds = async ids => {\n  spinner.spin(refs.libraryGallery);\n  const movieRequests = ids.map(id => fetchMovieById(id));\n  const result = await Promise.all(movieRequests);\n  spinner.stop();\n  return result;\n};\n\nconst renderLibraryMoviesData = movies => {\n  paginationMarkup(Math.ceil(movies.length / 20), siteConfigs.page);\n\n  const moviesData = movies.map(item => {\n    const newItem = { ...item };\n    newItem.genres = item.genres.map(genre => genre.name).join(', ');\n    const releaseDate = new Date(item['release_date']);\n    newItem.year = releaseDate.getFullYear();\n    newItem.vote = item['vote_average'].toFixed(1);\n    return newItem;\n  });\n\n  libraryPageUi.appendGalleryMarkup(moviesData);\n};\n","import { auth, getDataFromStorage } from './api/firebase/fireBase';\nimport storage from './local-storage/local-storage-service';\n\nexport const loadDataFromStorage = async key => {\n  console.log(2);\n  console.log(auth.currentUser);\n  if (auth.currentUser) {\n    return await getDataFromStorage(key);\n  } else {\n    return storage.load(key);\n  }\n};\n","import refs from '../refs/refs';\nimport storage from '../local-storage/local-storage-service';\nimport key from '../local-storage/local-storage-keys';\nimport { fetchMovieById } from '../api/movie-api/fetchMovieById';\nimport { siteConfigs } from '../SiteConfigs';\nimport libraryPageUi from '../ui/library-page-ui';\nimport paginationMarkup from '../pagination';\nimport { loadDataFromStorage } from '../loadDataFromStorage';\nimport { spinner } from '../spinner';\n\nexport const queueTabClickHandler = async event => {\n  refs.queueTab.classList.add('tabs__btn--current');\n  refs.watchedTab.classList.remove('tabs__btn--current');\n\n  refs.libraryGallery.innerHTML = '';\n\n  const queueMovieIds = await loadDataFromStorage(key.QUEUE_MOVIES);\n\n  if (!queueMovieIds || queueMovieIds.length === 0)\n    return libraryPageUi.renderEmptyLibrary();\n\n  processMovieIds(queueMovieIds).then(data => {\n    renderLibraryMoviesData(data);\n  });\n};\n\nconst processMovieIds = ids => {\n  spinner.spin(refs.libraryGallery);\n  const movieRequests = ids.map(id => fetchMovieById(id));\n  const result = Promise.all(movieRequests);\n  spinner.stop();\n  return result;\n};\n\nconst renderLibraryMoviesData = movies => {\n  paginationMarkup(Math.ceil(movies.length / 20), siteConfigs.page);\n\n  const moviesData = movies.map(item => {\n    const newItem = { ...item };\n    newItem.genres = item.genres.map(genre => genre.name).join(', ');\n    const releaseDate = new Date(item['release_date']);\n    newItem.year = releaseDate.getFullYear();\n    newItem.vote = item['vote_average'].toFixed(1);\n    return newItem;\n  });\n\n  libraryPageUi.appendGalleryMarkup(moviesData);\n};\n","import { fetchMovieById } from '../api/movie-api/fetchMovieById';\nimport { renderOneMovieData } from '../render/renderOneMovieData';\nimport notifications from '../notifications';\nimport libraryPageUi from '../ui/library-page-ui';\nimport { spinner } from '../spinner';\nimport refs from '../refs/refs';\n\nexport const libraryGalleryClickHandler = async event => {\n  event.preventDefault();\n\n  const movieId = event.target.closest('a').dataset.id;\n\n  try {\n    spinner.spin(refs.libraryGallery);\n    const movieData = await fetchMovieById(movieId);\n    spinner.stop();\n    renderOneMovieData(movieData, libraryPageUi.appendMovieMarkup);\n  } catch (error) {\n    notifications.failedRequest();\n  }\n};\n","import libraryPageUi from './js/ui/library-page-ui';\nimport notifications from './js/notifications';\nimport './js/registration-modal';\nimport { watchedTabClickHandler } from './js/handlers/watchedTabClickHandler';\n\ninitLibraryPage().catch(error => {\n  notifications.failedRequest();\n});\n\nasync function initLibraryPage() {\n  libraryPageUi.setLibraryEventListeners();\n\n  try {\n    await watchedTabClickHandler();\n  } catch (error) {\n    notifications.failedRequest();\n  }\n}\n"],"names":["$3ILHO","parcelRequire","$ksVbb","$22d69105b6b46817$export$3c782b771183c062","async","key","console","log","auth","currentUser","getDataFromStorage","$4dtAK","default","load","$7adde4241450315e$export$1d0eac70273ba650","event","watchedTab","classList","add","queueTab","remove","libraryGallery","innerHTML","watchedMovieIds","$8LAK9","WATCHED_MOVIES","length","$a1e40e66b3fe34e7$export$2e2bcd8739ae039","renderEmptyLibrary","$7adde4241450315e$var$processMovieIds","then","data","$7adde4241450315e$var$renderLibraryMoviesData","ids","$04jNI","spinner","spin","movieRequests","map","id","$ag3f1","fetchMovieById","result","Promise","all","stop","movies","$2nhTy","Math","ceil","$oxp97","siteConfigs","page","moviesData","item","newItem","genres","genre","name","join","releaseDate","Date","year","getFullYear","vote","toFixed","appendGalleryMarkup","$eae4491cd19a0087$export$b893da611cba23f2","queueMovieIds","QUEUE_MOVIES","$eae4491cd19a0087$var$processMovieIds","$eae4491cd19a0087$var$renderLibraryMoviesData","$fa56778e4fed7762$export$90eeeefc2c5f03cc","preventDefault","movieId","target","closest","dataset","movieData","$cJ4l5","renderOneMovieData","appendMovieMarkup","error","$2Dfe2","failedRequest","addEventListener","registerForm","submitRegisterForm","goTopBtn","$9TiW2","backToTop","window","trackScroll","$2gAtb","movie","$hBEsZ","dynamicRefs","$b986f","watchedBtn","$9TOT1","modalWatchedBtnClickHandler","queueBtn","modalQueueBtnClickHandler","onOpenModal","playTrailer","$bZJOo","httpsYouTubeVideo","insertAdjacentHTML","scrollBy","setLibraryEventListeners","$ce3726a01b8ab25a$var$initLibraryPage","catch"],"version":3,"file":"library.6380d22d.js.map"}