{"mappings":"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","sources":["src/library.js","src/js/ui/library-page-ui.js","src/js/handlers/watchedTabClickHandler.js","src/js/handlers/queueTabClickHandler.js","src/js/handlers/libraryGalleryClickHandler.js"],"sourcesContent":["import MovieConfigs from './js/MovieConfigs';\nimport libraryPageUi from './js/ui/library-page-ui';\nimport notifications from './js/notifications';\nimport './js/registration-modal';\nimport { watchedTabClickHandler } from './js/handlers/watchedTabClickHandler';\n\nexport const libraryMovieConfigs = new MovieConfigs();\n\ninitLibraryPage().catch(error => {\n  notifications.failedRequest();\n});\n\nasync function initLibraryPage() {\n  libraryPageUi.setLibraryEventListeners();\n\n  try {\n    watchedTabClickHandler();\n  } catch (error) {\n    notifications.failedRequest();\n  }\n}\n","import refs from '../refs/refs';\nimport { watchedTabClickHandler } from '../handlers/watchedTabClickHandler';\nimport { queueTabClickHandler } from '../handlers/queueTabClickHandler';\nimport { libraryGalleryClickHandler } from '../handlers/libraryGalleryClickHandler';\nimport movieCards from '../../templates/movie-card.hbs';\nimport { dynamicRefs } from '../refs/dynamicRefs';\nimport modalMovie from '../../templates/modal-for-movie.hbs';\nimport {\n  modalQueueBtnClickHandler,\n  modalWatchedBtnClickHandler,\n  onOpenModal,\n} from '../handlers/modalBtnsClickHandler';\nimport { httpsYouTubeVideo } from '../you-tube';\n\nconst setLibraryEventListeners = () => {\n  refs.watchedTab.addEventListener('click', watchedTabClickHandler);\n  refs.queueTab.addEventListener('click', queueTabClickHandler);\n  refs.libraryGallery.addEventListener('click', libraryGalleryClickHandler);\n};\n\nconst appendGalleryMarkup = movies => {\n  refs.libraryGallery.innerHTML = movieCards(movies);\n};\n\nconst appendMovieMarkup = movie => {\n  dynamicRefs().movieData.innerHTML = modalMovie(movie);\n\n  dynamicRefs().watchedBtn.addEventListener(\n    'click',\n    modalWatchedBtnClickHandler\n  );\n  dynamicRefs().queueBtn.addEventListener('click', modalQueueBtnClickHandler);\n  onOpenModal(movie.id);\n  dynamicRefs().playTrailer.addEventListener('click', httpsYouTubeVideo);\n};\n\nexport default {\n  setLibraryEventListeners,\n  appendGalleryMarkup,\n  appendMovieMarkup,\n};\n","import refs from '../refs/refs';\nimport storage from '../local-storage/local-storage-service';\nimport key from '../local-storage/local-storage-keys';\nimport { fetchMovieById } from '../api/movie-api/fetchMovieById';\nimport { libraryMovieConfigs } from '../../library';\nimport libraryPageUi from '../ui/library-page-ui';\nimport paginationMarkup from '../pagination';\n// import { Spinner } from 'spin.js';\n// import 'spin.js/spin.css';\n// import spinnerConfigs from '../spinner';\n\n\nconst spinner = new Spinner(spinnerConfigs);\n\nexport const watchedTabClickHandler = event => {\n  refs.watchedTab.classList.add('tabs__btn--current');\n  refs.queueTab.classList.remove('tabs__btn--current');\n\n  refs.libraryGallery.innerHTML = '';\n\n  const watchedMovieIds = storage.load(key.WATCHED_MOVIES);\n  \n  if (!watchedMovieIds || watchedMovieIds.length === 0)\n    return refs.libraryGallery.insertAdjacentHTML(\n      'afterbegin',\n      '<p class=\"empty-page__text\"> Nothing to see here<br>Add a movie please</p>'\n    );\n    \n    processMovieIds(watchedMovieIds).then(data => {\n      renderLibraryMoviesData(data);\n    });\n};\n\nconst processMovieIds = async ids => {\n  const movieRequests = ids.map(id => fetchMovieById(id));\n  const result = await Promise.all(movieRequests);\n  return result;\n};\n\nconst renderLibraryMoviesData = movies => {\n  paginationMarkup((movies.length / 20).toFixed(), libraryMovieConfigs.page);\n\n  const moviesData = movies.map(item => {\n    const newItem = { ...item };\n    newItem.genres = item.genres.map(genre => genre.name).join(', ');\n    const releaseDate = new Date(item['release_date']);\n    newItem.year = releaseDate.getFullYear();\n    newItem.vote = item['vote_average'].toFixed(1);\n    return newItem;\n  });\n\n  libraryPageUi.appendGalleryMarkup(moviesData);\n};\n","import refs from '../refs/refs';\nimport storage from '../local-storage/local-storage-service';\nimport key from '../local-storage/local-storage-keys';\nimport { fetchMovieById } from '../api/movie-api/fetchMovieById';\nimport { libraryMovieConfigs } from '../../library';\nimport libraryPageUi from '../ui/library-page-ui';\nimport paginationMarkup from '../pagination';\n\nexport const queueTabClickHandler = event => {\n  refs.queueTab.classList.add('tabs__btn--current');\n  refs.watchedTab.classList.remove('tabs__btn--current');\n\n  refs.libraryGallery.innerHTML = '';\n\n  const queueMovieIds = storage.load(key.QUEUE_MOVIES);\n  if (!queueMovieIds || queueMovieIds.length === 0)\n    return refs.libraryGallery.insertAdjacentHTML(\n      'afterbegin',\n      '<p class=\"empty-page__text\"> Nothing to see here<br>Add a movie please</p>'\n    );\n    \n  processMovieIds(queueMovieIds).then(data => {\n    renderLibraryMoviesData(data);\n  });\n};\n\nconst processMovieIds = ids => {\n  const movieRequests = ids.map(id => fetchMovieById(id));\n  const result = Promise.all(movieRequests);\n  return result;\n};\n\nconst renderLibraryMoviesData = movies => {\n  paginationMarkup((movies.length / 20).toFixed(), libraryMovieConfigs.page);\n\n  const moviesData = movies.map(item => {\n    const newItem = { ...item };\n    newItem.genres = item.genres.map(genre => genre.name).join(', ');\n    const releaseDate = new Date(item['release_date']);\n    newItem.year = releaseDate.getFullYear();\n    newItem.vote = item['vote_average'].toFixed(1);\n    return newItem;\n  });\n\n  libraryPageUi.appendGalleryMarkup(moviesData);\n};\n","import { fetchMovieById } from '../api/movie-api/fetchMovieById';\nimport { renderOneMovieData } from '../render/renderOneMovieData';\nimport notifications from '../notifications';\nimport libraryPageUi from '../ui/library-page-ui';\n\nexport const libraryGalleryClickHandler = async event => {\n  event.preventDefault();\n\n  const movieId = event.target.closest('a').dataset.id;\n\n  try {\n    const movieData = await fetchMovieById(movieId);\n    renderOneMovieData(movieData, libraryPageUi.appendMovieMarkup);\n  } catch (error) {\n    notifications.failedRequest();\n  }\n};\n"],"names":["$bpxeT","parcelRequire","$cqmI4","$b7a091296392bda0$export$1d0eac70273ba650","Spinner","spinnerConfigs","event","default","watchedTab","classList","add","queueTab","remove","libraryGallery","innerHTML","watchedMovieIds","$daTbb","load","$2hVIf","WATCHED_MOVIES","length","insertAdjacentHTML","$b7a091296392bda0$var$processMovieIds","then","data","$b7a091296392bda0$var$renderLibraryMoviesData","$parcel$interopDefault","$2TvXO","mark","_callee","ids","movieRequests","result","map","id","$bDPyF","fetchMovieById","Promise","all","_ctx","sent","movies","$jcFG7","toFixed","$cecbdd76f2d3d4bd$export$5f907f6196637931","page","moviesData","item","newItem","$dDDEV","genres","genre","name","join","releaseDate","Date","year","getFullYear","vote","$40377827cb75a7ee$export$2e2bcd8739ae039","appendGalleryMarkup","$f989e53ddbad5979$export$b893da611cba23f2","queueMovieIds","QUEUE_MOVIES","$f989e53ddbad5979$var$processMovieIds","$f989e53ddbad5979$var$renderLibraryMoviesData","$b5c2143266c4353e$export$90eeeefc2c5f03cc","movieId","movieData","preventDefault","target","closest","dataset","$frmlX","renderOneMovieData","appendMovieMarkup","$aYvV9","failedRequest","setLibraryEventListeners","addEventListener","$8pYMx","movie","$d5Phe","dynamicRefs","$1MwiW","watchedBtn","$8gEWs","modalWatchedBtnClickHandler","queueBtn","modalQueueBtnClickHandler","onOpenModal","playTrailer","$hV87x","httpsYouTubeVideo","$l1krc","$cecbdd76f2d3d4bd$var$_initLibraryPage","error","apply","this","arguments","$cecbdd76f2d3d4bd$var$initLibraryPage","catch"],"version":3,"file":"library.ee1f3ebe.js.map"}