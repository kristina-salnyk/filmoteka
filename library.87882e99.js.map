{"mappings":"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","sources":["src/library.js","src/js/ui/library-page-ui.js","src/js/handlers/watchedTabClickHandler.js","src/js/loadDataFromStorage.js","src/js/handlers/queueTabClickHandler.js","src/js/handlers/libraryGalleryClickHandler.js"],"sourcesContent":["import libraryPageUi from './js/ui/library-page-ui';\nimport notifications from './js/notifications';\nimport './js/registration-modal';\nimport { watchedTabClickHandler } from './js/handlers/watchedTabClickHandler';\n\ninitLibraryPage().catch(error => {\n  notifications.failedRequest();\n});\n\nasync function initLibraryPage() {\n  libraryPageUi.setLibraryEventListeners();\n\n  try {\n    await watchedTabClickHandler();\n  } catch (error) {\n    notifications.failedRequest();\n  }\n}\n","import refs from '../refs/refs';\nimport { watchedTabClickHandler } from '../handlers/watchedTabClickHandler';\nimport { queueTabClickHandler } from '../handlers/queueTabClickHandler';\nimport { libraryGalleryClickHandler } from '../handlers/libraryGalleryClickHandler';\nimport movieCards from '../../templates/movie-card.hbs';\nimport { dynamicRefs } from '../refs/dynamicRefs';\nimport { trackScroll, backToTop } from '../handlers/scrollUpClickHandler';\nimport modalMovie from '../../templates/modal-for-movie.hbs';\nimport {\n  modalQueueBtnClickHandler,\n  modalWatchedBtnClickHandler,\n  onOpenModal,\n} from '../handlers/modalBtnsClickHandler';\nimport { httpsYouTubeVideo } from '../you-tube';\nimport { submitRegisterForm } from '../api/firebase/fireBase';\n\nconst setLibraryEventListeners = () => {\n  refs.watchedTab.addEventListener('click', watchedTabClickHandler);\n  refs.queueTab.addEventListener('click', queueTabClickHandler);\n  refs.libraryGallery.addEventListener('click', libraryGalleryClickHandler);\n  refs.registerForm.addEventListener('submit', submitRegisterForm);\n  refs.goTopBtn.addEventListener('click', backToTop);\n  window.addEventListener('scroll', trackScroll);\n};\n\nconst appendGalleryMarkup = movies => {\n  refs.libraryGallery.innerHTML = movieCards(movies);\n};\n\nconst appendMovieMarkup = movie => {\n  dynamicRefs().movieData.innerHTML = modalMovie(movie);\n\n  dynamicRefs().watchedBtn.addEventListener(\n    'click',\n    modalWatchedBtnClickHandler\n  );\n  dynamicRefs().queueBtn.addEventListener('click', modalQueueBtnClickHandler);\n  onOpenModal(movie.id);\n  dynamicRefs().playTrailer.addEventListener('click', httpsYouTubeVideo);\n};\n\nfunction renderEmptyLibrary() {\n  const fillerLibrary =\n    '<p class=\"empty-page__text\"> Nothing to see here<br>Add a movie please</p>';\n  refs.libraryGallery.insertAdjacentHTML('afterbegin', fillerLibrary);\n}\nconst scrollToTop = () => {\n  window.scrollBy(0, 0);\n};\n\nexport default {\n  setLibraryEventListeners,\n  appendGalleryMarkup,\n  appendMovieMarkup,\n  renderEmptyLibrary,\n  scrollToTop,\n};\n","import refs from '../refs/refs';\nimport storage from '../local-storage/local-storage-service';\nimport key from '../local-storage/local-storage-keys';\nimport { fetchMovieById } from '../api/movie-api/fetchMovieById';\nimport libraryPageUi from '../ui/library-page-ui';\nimport paginationMarkup from '../pagination';\nimport { loadDataFromStorage } from '../loadDataFromStorage';\nimport { spinner } from '../spinner';\nimport { siteConfigs } from '../SiteConfigs';\n\nexport const watchedTabClickHandler = async event => {\n  console.log(1);\n  refs.watchedTab.classList.add('tabs__btn--current');\n  refs.queueTab.classList.remove('tabs__btn--current');\n\n  refs.libraryGallery.innerHTML = '';\n\n  const watchedMovieIds = await loadDataFromStorage(key.WATCHED_MOVIES);\n\n  if (!watchedMovieIds || watchedMovieIds.length === 0)\n    return libraryPageUi.renderEmptyLibrary();\n\n  processMovieIds(watchedMovieIds).then(data => {\n    renderLibraryMoviesData(data);\n  });\n};\n\nconst processMovieIds = async ids => {\n  spinner.spin(refs.libraryGallery);\n  const movieRequests = ids.map(id => fetchMovieById(id));\n  const result = await Promise.all(movieRequests);\n  spinner.stop();\n  return result;\n};\n\nconst renderLibraryMoviesData = movies => {\n  paginationMarkup(Math.ceil(movies.length / 20), siteConfigs.page);\n\n  const moviesData = movies.map(item => {\n    const newItem = { ...item };\n    newItem.genres = item.genres.map(genre => genre.name).join(', ');\n    const releaseDate = new Date(item['release_date']);\n    newItem.year = releaseDate.getFullYear();\n    newItem.vote = item['vote_average'].toFixed(1);\n    return newItem;\n  });\n\n  libraryPageUi.appendGalleryMarkup(moviesData);\n};\n","import { auth, getDataFromStorage } from './api/firebase/fireBase';\nimport storage from './local-storage/local-storage-service';\n\nexport const loadDataFromStorage = async key => {\n  console.log(2);\n  console.log(auth.currentUser);\n  if (auth.currentUser) {\n    return await getDataFromStorage(key);\n  } else {\n    return storage.load(key);\n  }\n};\n","import refs from '../refs/refs';\nimport storage from '../local-storage/local-storage-service';\nimport key from '../local-storage/local-storage-keys';\nimport { fetchMovieById } from '../api/movie-api/fetchMovieById';\nimport { siteConfigs } from '../SiteConfigs';\nimport libraryPageUi from '../ui/library-page-ui';\nimport paginationMarkup from '../pagination';\nimport { loadDataFromStorage } from '../loadDataFromStorage';\nimport { spinner } from '../spinner';\n\nexport const queueTabClickHandler = async event => {\n  refs.queueTab.classList.add('tabs__btn--current');\n  refs.watchedTab.classList.remove('tabs__btn--current');\n\n  refs.libraryGallery.innerHTML = '';\n\n  const queueMovieIds = await loadDataFromStorage(key.QUEUE_MOVIES);\n\n  if (!queueMovieIds || queueMovieIds.length === 0)\n    return libraryPageUi.renderEmptyLibrary();\n\n  processMovieIds(queueMovieIds).then(data => {\n    renderLibraryMoviesData(data);\n  });\n};\n\nconst processMovieIds = ids => {\n  spinner.spin(refs.libraryGallery);\n  const movieRequests = ids.map(id => fetchMovieById(id));\n  const result = Promise.all(movieRequests);\n  spinner.stop();\n  return result;\n};\n\nconst renderLibraryMoviesData = movies => {\n  paginationMarkup(Math.ceil(movies.length / 20), siteConfigs.page);\n\n  const moviesData = movies.map(item => {\n    const newItem = { ...item };\n    newItem.genres = item.genres.map(genre => genre.name).join(', ');\n    const releaseDate = new Date(item['release_date']);\n    newItem.year = releaseDate.getFullYear();\n    newItem.vote = item['vote_average'].toFixed(1);\n    return newItem;\n  });\n\n  libraryPageUi.appendGalleryMarkup(moviesData);\n};\n","import { fetchMovieById } from '../api/movie-api/fetchMovieById';\nimport { renderOneMovieData } from '../render/renderOneMovieData';\nimport notifications from '../notifications';\nimport libraryPageUi from '../ui/library-page-ui';\nimport { spinner } from '../spinner';\nimport refs from '../refs/refs';\n\nexport const libraryGalleryClickHandler = async event => {\n  event.preventDefault();\n\n  const movieId = event.target.closest('a').dataset.id;\n\n  try {\n    spinner.spin(refs.libraryGallery);\n    const movieData = await fetchMovieById(movieId);\n    spinner.stop();\n    renderOneMovieData(movieData, libraryPageUi.appendMovieMarkup);\n  } catch (error) {\n    notifications.failedRequest();\n  }\n};\n"],"names":["$bpxeT","parcelRequire","$cqmI4","$195c4b0c466d6e49$export$3c782b771183c062","$parcel$interopDefault","$2TvXO","mark","_callee","key","console","log","$hE6Pt","auth","currentUser","getDataFromStorage","$daTbb","default","load","$b7a091296392bda0$export$1d0eac70273ba650","event","watchedMovieIds","watchedTab","classList","add","queueTab","remove","libraryGallery","innerHTML","$2hVIf","WATCHED_MOVIES","_ctx","sent","length","$40377827cb75a7ee$export$2e2bcd8739ae039","renderEmptyLibrary","$b7a091296392bda0$var$processMovieIds","then","data","$b7a091296392bda0$var$renderLibraryMoviesData","ids","movieRequests","result","$j1lrD","spinner","spin","map","id","$bDPyF","fetchMovieById","Promise","all","stop","movies","$jcFG7","Math","ceil","$ismrh","siteConfigs","page","moviesData","item","newItem","$dDDEV","genres","genre","name","join","releaseDate","Date","year","getFullYear","vote","toFixed","appendGalleryMarkup","$f989e53ddbad5979$export$b893da611cba23f2","queueMovieIds","QUEUE_MOVIES","$f989e53ddbad5979$var$processMovieIds","$f989e53ddbad5979$var$renderLibraryMoviesData","$b5c2143266c4353e$export$90eeeefc2c5f03cc","movieId","movieData","preventDefault","target","closest","dataset","$frmlX","renderOneMovieData","appendMovieMarkup","$aYvV9","failedRequest","setLibraryEventListeners","addEventListener","registerForm","submitRegisterForm","goTopBtn","$iObGl","backToTop","window","trackScroll","$8pYMx","movie","$d5Phe","dynamicRefs","$1MwiW","watchedBtn","$8gEWs","modalWatchedBtnClickHandler","queueBtn","modalQueueBtnClickHandler","onOpenModal","playTrailer","$hV87x","httpsYouTubeVideo","insertAdjacentHTML","scrollToTop","scrollBy","$cecbdd76f2d3d4bd$var$_initLibraryPage","apply","this","arguments","$cecbdd76f2d3d4bd$var$initLibraryPage","catch","error"],"version":3,"file":"library.87882e99.js.map"}